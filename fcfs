#include <stdio.h>

#define MAX_FRAMES 3  // Minimum frame size of 3

// Function to check if the page is already in memory
int isPageInMemory(int page, int memory[], int frameSize) {
    for (int i = 0; i < frameSize; i++) {
        if (memory[i] == page) {
            return 1;  // Page is already in memory
        }
    }
    return 0;  // Page is not in memory
}

// Function to simulate FCFS page replacement algorithm
void fcfsPageReplacement(int pages[], int numPages, int frameSize) {
    int memory[frameSize];  // Memory frames
    int pageFaults = 0;     // Count of page faults

    // Initialize the memory with -1 (indicating empty frames)
    for (int i = 0; i < frameSize; i++) {
        memory[i] = -1;
    }

    int nextFrame = 0;  // Pointer to the next frame to be replaced (First-Come-First-Serve)

    for (int i = 0; i < numPages; i++) {
        int currentPage = pages[i];

        // If the page is not in memory, it's a page fault
        if (!isPageInMemory(currentPage, memory, frameSize)) {
            pageFaults++;

            // Replace the page using FCFS (first empty frame or replace the oldest page)
            memory[nextFrame] = currentPage;

            // Move to the next frame for the next replacement
            nextFrame = (nextFrame + 1) % frameSize;

            printf("Page %d caused a page fault. Frame state: ", currentPage);
            for (int j = 0; j < frameSize; j++) {
                if (memory[j] != -1)
                    printf("%d ", memory[j]);
                else
                    printf("Empty ");
            }
            printf("\n");
        } else {
            printf("Page %d already in memory. Frame state: ", currentPage);
            for (int j = 0; j < frameSize; j++) {
                if (memory[j] != -1)
                    printf("%d ", memory[j]);
                else
                    printf("Empty ");
            }
            printf("\n");
        }
    }

    printf("\nTotal page faults: %d\n", pageFaults);
}

int main() {
    // Sample page reference string
    int pages[] = {1, 2, 3, 1, 4, 2, 3};
    int numPages = sizeof(pages) / sizeof(pages[0]);

    printf("Page Replacement using FCFS Algorithm:\n");
    fcfsPageReplacement(pages, numPages, MAX_FRAMES);

    return 0;
}
